!function(){"use strict";d3.timeline=function(){function a(a){function b(){return d3.svg.axis().scale(H).orient("bottom").tickFormat("").tickSubdivide(1).tickValues(d3.range(m.getFullYear(),n.getFullYear()+1)).tickSize(-h,j.tickSize/2,0)}function k(a,b){return o.left+(a.starting_time-m)*G}function l(a,b){return(a.ending_time-a.starting_time)*G}function u(a){if(B.attr("height"))h=i?i:B.attr("height");else{if(!r)throw"height of the timeline is not set";h=a.height+a.top-A.top}}function v(b){if(i||B.attr("height"))i?B.attr("height",i):i=B.attr("height");else{if(!r)throw"height of the timeline is not set";i=b.height+b.top-A.top,d3.select(a[0][0]).attr("height",i)}}function w(){if(!g&&!A.width)throw"width of the timeline is not set";g&&A.width||(g?B.attr("width",g):g=B.attr("width"))}function x(a,b,c,d,e){return"M"+a+","+b+"h"+(c-e)+"l"+e+", "+d/2+"l"+-e+", "+d/2+"h"+(e-c)+"z"}function y(a,b,c,d,e){return"M"+a+","+b+"h"+c+"v"+d+"h"+-c+"z"}var z=a.append("g"),A=a[0][0].getBoundingClientRect(),B=d3.select(a[0][0]),C={},D=1,E=0,F=0;w(),(p||0===n&&0===m)&&(z.each(function(a,b){a.forEach(function(a,b){p&&Object.keys(C).indexOf(b)==-1&&(C[b]=D,D++),0===n&&0===m&&a.events.forEach(function(a,b){(a.starting_time<E||0===E)&&(E=a.starting_time),a.ending_time>F&&(F=a.ending_time)})})}),0===n&&0===m&&(m=E,n=F));var G=1/(n-m)*(g-o.left-o.right),H=d3.time.scale().domain([m.getFullYear(),n.getFullYear()]).range([o.left,g-o.right]),I=d3.range(m.getFullYear(),n.getFullYear()+1),J=d3.svg.axis().scale(H).orient(f).tickFormat(j.format).tickSubdivide(1).tickValues(I).tickSize(j.tickSize,j.tickSize/2,0);z.append("g").attr("class","axis").attr("transform","translate(0,"+(o.top+(r+s)*D)+")").call(J),u(z[0][0].getBoundingClientRect()),q&&z.selectAll("text").style("text-anchor","end").attr("dx","3em").attr("dy",".15em").attr("transform","rotate("+q+")"),v(z[0][0].getBoundingClientRect()),z.append("g").attr("class","grid").attr("transform","translate(0,"+(h-2*j.tickSize)+")").call(b()),z.append("g").attr("class","grid-tooltip").attr("transform","translate(0,"+(h-2*j.tickSize)+")").call(b()),d3.selectAll(".grid-tooltip > .tick").each(function(a,b){d3.select(this).attr("stroke-width",t+"px").insert("title",":first-child").html(a)}),z.each(function(b,f){b.forEach(function(g,h){function i(a,b){return p?o.top+(r+s)*C[h]:o.top}var j=g.events,m="undefined"!=typeof g.label;if(z.selectAll("svg").data(j).enter().append("path").attr("id","line-path").attr("d",function(a,b){var c=k(a,b),d=i(a,b),e=l(a,b);return a.ongoing?x(c,d,e,r,5):y(c,d,e,r,5)}).style("fill",g.color).on("mouseover",function(a,b){c(a,h,g)}).on("click",function(a,b){d(a,h,g)}).append("title").text(function(a){return e(a,f,g)}),m){var n=r+s,q=o.top+n/2+n*(C[h]||1);a.append("text").attr("class","timeline-label").attr("text-anchor","end").attr("transform","translate("+(o.left-s)+","+q+")").text(m?g.label:g.id).on("click",function(a,b){d(a,h,g)}).insert("title",":first-child").html(e(b,f,g))}"undefined"!=typeof g.icon&&a.append("image").attr("class","timeline-label").attr("transform","translate(0,"+(o.top+(r+s)*C[h])+")").attr("xlink:href",g.icon).attr("width",o.left).attr("height",r)})})}var b=["circle","rect"],c=function(){},d=function(){},e=function(a,b,c){return a.title},f="bottom",g=null,h=null,i=null,j={format:d3.format("d"),tickTime:1,tickNumber:1,tickSize:10},k=d3.scale.category20(),l="rect",m=0,n=0,o={left:30,right:30,top:30,bottom:30},p=!1,q=!1,r=10,s=5,t=10;return a.margin=function(b){return arguments.length?(o=b,a):o},a.orient=function(b){return arguments.length?(f=b,a):f},a.itemHeight=function(b){return arguments.length?(r=b,a):r},a.itemMargin=function(b){return arguments.length?(s=b,a):s},a.height=function(b){return arguments.length?(i=b,a):i},a.width=function(b){return arguments.length?(g=b,a):g},a.display=function(c){return arguments.length&&b.indexOf(c)!=-1?(l=c,a):l},a.tickFormat=function(b){return arguments.length?(j=b,a):j},a.hover=function(b){return arguments.length?(c=b,a):c},a.click=function(b){return arguments.length?(d=b,a):d},a.colors=function(b){return arguments.length?(k=b,a):k},a.beginning=function(b){return arguments.length?(m=b,a):m},a.ending=function(b){return arguments.length?(n=b,a):n},a.rotateTicks=function(b){return q=b,a},a.stack=function(){return p=!p,a},a.strokeWidth=function(b){return t=b,a},a.tooltipFormatter=function(b){return b&&(e=b),a},a}}(),function(a){"use strict";function b(a){const b=a.split(/-/).map(function(a){return parseInt(a)});return c(b[0],b[1]-1,b[2])}function c(a,b,c){return new Date(a,b,c)}function d(a,b){return c(a,(b||1)-1,1)}function e(a,b){var d=(b||12)-1,e=new Date(a,d+1,0).getDate();return c(a,d,e)}function f(a){(a||[]).sort(function(a,b){return a.weight-b.weight})}function g(c){a.each(c,function(c,g){g.hasOwnProperty("dataCollectionEvents")&&(f(g.dataCollectionEvents),a.each(g.dataCollectionEvents,function(a,c){c.startDate=c.startDay?b(c.startDay):d(c.startYear,c.startMonth);var f=c.endYear;c.ongoing=!f,f||(f=m>c.startYear?m:c.startYear),c.endDate=c.endDay?b(c.endDay):e(f,c.endMonth)}))})}function h(b){var c=Number.MAX_VALUE,e=Number.MIN_VALUE;return a.each(b,function(b,d){d.hasOwnProperty("dataCollectionEvents")&&a.each(d.dataCollectionEvents,function(a,b){c=Math.min(c,b.startDate.getFullYear());var d=b.endDate.getFullYear();e<d&&(e=d)})}),{min:d(c),max:d(e+1)}}function i(a,b){var c=j(a,b);if(0===c.length)return null;var d={start:b.start,min:b.min,max:b.max,data:c};return d}function j(b,c){function d(b){return function(d,f){var j=[];i={},e(i,f,"id"),g(i,f,"name"),i.color=l.nextColor(),f.hasOwnProperty("dataCollectionEvents")&&f.dataCollectionEvents.length>0&&(h(j,i,f.dataCollectionEvents,c),a.each(j,function(a,c){b.push(c)}))}}function e(a,b,c){b.hasOwnProperty(c)&&(a[c]=b[c])}function f(b){var c=b[0].value;return a.each(b,function(a,b){b.lang==k&&(c=b.value)}),c}function g(a,b,c){b.hasOwnProperty(c)&&(a.title=f(b[c]))}function h(b,c,d,f){function h(a,b,c,d){return Math.min(b,d)-Math.max(c,a)>0}function i(a,b,c){var d=jQuery.extend({},a);return d.events=[j(b,c)],d}function j(a,b){var c={};return e(c,a,"id"),g(c,a,"name"),k(c,a,b),l(c,a,b),m(c,a),c}function k(a,b,c){a.starting_time=b.startDate}function l(a,b,c){a.ending_time=b.endDate}function m(a,b){a.ongoing=b.ongoing,a.ending_time=b.endDate}if(!jQuery.isEmptyObject(d)){var n=jQuery.extend(!0,{},d);a.each(n,function(a,d){if("0"===a)b.push(i(c,d,f));else{for(var e=b[b.length-1].events,g=d.startDate,k=d.endDate,l=!1,m=null,n=e.length-1;n>=0&&!l;n--)m=e[n],h(g,k,m.starting_time,m.ending_time)&&(b.push(i(c,d,f)),l=!0);l||e.push(j(d,f,m.groupId))}})}}if(null!==b&&b.hasOwnProperty("populations")){var i,j=[];return a.each(b.populations,d(j)),j}}var k,l,m=(new Date).getFullYear();a.StudyDtoParser=function(b){k=b?b:"en",l=new a.ColorGenerator},a.StudyDtoParser.prototype={colorGenerator:function(a){return a&&(l=a),this},parse:function(a){return a.populations?(g(a.populations),i(a,h(a.populations))):null}}}(jQuery),function(a){"use strict";function b(a,b,c){return new Date(a,b,c)}function c(a,c){return b(a,(c||1)-1,1)}function d(a,c){var d=(c||12)-1,e=new Date(a,d+1,0).getDate();return b(a,d,e)}function e(a){!a.hasOwnProperty("model")&&a.hasOwnProperty("content")&&(a.model=JSON.parse(a.content))}function f(a){var b=a.model.startYear||t;a.model.startDate=c(b);var e=a.model.endYear;a.model.ongoing=!e,e||(e=t>b?t:b),a.model.endDate=d(e)}function g(b){a.each(b,function(a,b){e(b),f(b)})}function h(b){var d=Number.MAX_VALUE,e=Number.MIN_VALUE;return a.each(b,function(a,b){if(b.model){d=Math.min(d,b.model.startDate.getFullYear());var c=b.model.endDate.getFullYear();e<c&&(e=c)}}),{min:c(d),max:c(e+1)}}function i(b,c){var d,e=s.nextColor(),f=[],g="";if(a.each(b,function(a,b){d={},j(d,b,"id"),l(d,b,"name"),d.label=k(b.acronym),d.color=e,g.length<d.label.length&&(g=d.label),f.push(m(d,b,c))}),f.length<1)return null;var h={start:c.start,min:c.min,max:c.max,data:f,longestLabel:g};return h}function j(a,b,c){b.hasOwnProperty(c)&&(a[c]=b[c])}function k(b){var c=b[0].value;return a.each(b,function(a,b){b.lang==r&&(c=b.value)}),c}function l(a,b,c){b.hasOwnProperty(c)&&(a.title=k(b[c]))}function m(a,b,c){var d=jQuery.extend({},a);return d.events=[n(b)],d}function n(a){var b={};return j(b,a,"id"),l(b,a,"name"),o(b,a),p(b,a),q(b,a),b}function o(a,b){a.starting_time=b.model.startDate}function p(a,b){a.ending_time=b.model.endDate}function q(a,b){a.ongoing=b.model.ongoing,a.ending_time=b.model.endDate}var r,s,t=(new Date).getFullYear();a.StudiesDtoParser=function(b){r=b?b:"en",s=new a.ColorGenerator},a.StudiesDtoParser.prototype={setColorGenerator:function(a){return a&&(s=a),this},parse:function(a){if(a){g(a);var b=i(a,h(a));return b}return null}}}(jQuery),function(a){"use strict";function b(a,b){var c=String(a).replace(/[^0-9a-f]/gi,"");c.length<6&&(c=c[0]+c[0]+c[1]+c[1]+c[2]+c[2]),b=b||0;var d,e,f="#";for(e=0;e<3;e++)d=parseInt(c.substr(2*e,2),16),d=Math.round(Math.min(Math.max(0,d+d*b),255)).toString(16),f+=("00"+d).substr(d.length);return f}var c=["#9a3034","#886e6a","#dc9351","#0078ad","#8db173","#bca68e","#707175","#ff7901","#88697b","#99c1c3","#306d05","#f25314"];a.ColorGenerator=function(a){this.colorPalette=jQuery.isEmptyObject(a)?c:a,this.index=0,this.rotation=1},a.ColorGenerator.prototype={nextColor:function(){var a=b(this.colorPalette[this.index],(this.rotation%10===0?-1:1)*this.rotation/70);return this.index=(this.index+1)%this.colorPalette.length,0===this.index&&this.rotation++,a}}}(jQuery),function(a){"use strict";function b(a){if(d3){var b=d3.select("body").append("svg");b.append("text").attr("class","timeline-label").attr({x:-99999,y:-99999}).text(a);var c=b.node().getBBox();return b.remove(),{width:c.width,height:c.height}}}function c(a){if(d3){var b=d3.select("body").append("svg");b.append("g").attr("class","axis").append("text").attr({x:-99999,y:-99999}).text(a);var c=b.node().getBBox();return b.remove(),{width:c.width,height:c.height}}}function d(d,e,f,g){var h=a(f).width(),i={left:15+(e.longestLabel?b(e.longestLabel).width:0),right:15,top:0,bottom:20},j=e.max.getFullYear()-e.min.getFullYear()+1,k=Math.floor((h-i.right-i.left)/j),l=Math.floor(c("9999").width),m=function(a,b){return d3.format("d")(a)};if(k<12){var n=Math.floor((h-i.right-i.left)/l),o=Math.ceil(j/n);m=function(a,b){return b%o===0?d3.format("d")(a):""}}var p=d3.timeline().beginning(e.min).ending(e.max).width(h).stack().tickFormat({format:m,tickTime:1,tickNumber:1,tickSize:10}).margin(i).strokeWidth(k).rotateTicks(k>=12&&e.max.getFullYear()-e.min.getFullYear()>30?45:0).click(function(a,b,c){d.clickHandler&&d.clickHandler.call(null,g,c,a)}).tooltipFormatter(d.tooltipFormatter);d3.select(f).append("svg").attr("width",h).datum(e.data).call(p),d.useBootstrapTooltip===!0&&d3.select(f).selectAll("#line-path").attr("data-placement","top").attr("data-toggle","tooltip").attr("title",function(a){return a.title}).selectAll("title").remove(),d.timelineData=e,d.selectee=f}function e(b,c){var d="<rect width='20' height='20' x='2' y='2' rx='5' ry='5' style='fill:COLOR;'>".replace(/COLOR/,b);return a("<li><svg width='25' height='25'>"+d+"</svg>"+c+"</li>")}a.MicaTimeline=function(a,b,c,d){this.parser=a,this.clickHandler=b,this.useBootstrapTooltip=c,this.tooltipFormatter=d},a.MicaTimeline.prototype={create:function(a,b){var c=jQuery.extend(!0,{},b);if(null!==this.parser&&null!==c){var e=this.parser.parse(c);return e&&d(this,e,a,c),this}},addLegend:function(){if(this.timelineData&&this.timelineData.hasOwnProperty("data")&&0!==this.timelineData.data.length){var b=a("<ul id='legend' class='timeline-legend'>");a(this.selectee).after(b);var c={};return a.each(this.timelineData.data,function(d,f){if(!c.hasOwnProperty(f.title)){c[f.title]=!0;var g=a(e(f.color,f.title));b.append(g)}}),this}},reset:function(){return a(this.selectee).empty(),a(".timeline-legend").remove(),this}},a.MicaTimeline.defaultOptions={maxMonths:300}}(jQuery);